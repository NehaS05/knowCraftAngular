<div class="analytics-container">
  <div class="analytics-header">
    <div>
      <h1>Analytics Dashboard</h1>
      <p class="subtitle">Monitor AI assistant performance and usage metrics</p>
    </div>
    <div class="header-actions">
      <button class="refresh-btn" (click)="refreshAnalytics()" [disabled]="loading">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <polyline points="23 4 23 10 17 10"></polyline>
          <polyline points="1 20 1 14 7 14"></polyline>
          <path d="M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"></path>
        </svg>
        {{ loading ? 'Loading...' : 'Refresh' }}
      </button>
    </div>
  </div>

  <!-- Loading State -->
  <div class="loading-state" *ngIf="loading && !analytics">
    <div class="loading-spinner"></div>
    <p>Loading analytics data...</p>
  </div>

  <!-- Error State -->
  <div class="error-state" *ngIf="error && !loading">
    <div class="error-icon">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <circle cx="12" cy="12" r="10"></circle>
        <line x1="15" y1="9" x2="9" y2="15"></line>
        <line x1="9" y1="9" x2="15" y2="15"></line>
      </svg>
    </div>
    <p>{{ error }}</p>
    <button class="retry-btn" (click)="refreshAnalytics()">Try Again</button>
  </div>

  <!-- Analytics Content -->
  <div class="analytics-content" *ngIf="!loading && !error && analytics">
    <div class="metrics-grid">
      <!-- Dynamic Metric Cards -->
      <div class="metric-card" *ngFor="let metric of metrics">
        <div class="metric-header">
          <span class="metric-title">{{ metric.title }}</span>
          <div class="metric-icon">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" *ngIf="metric.icon === 'message'">
              <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
            </svg>
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" *ngIf="metric.icon === 'users'">
              <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
              <circle cx="9" cy="7" r="4"></circle>
              <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
              <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
            </svg>
          </div>
        </div>
        <div class="metric-value">{{ metric.value | number }}</div>
        <div class="metric-change" [ngClass]="metric.changeType">{{ metric.change }}</div>
      </div>
    </div>

    <!-- Additional Analytics Section -->
    <div class="additional-metrics" *ngIf="analytics.totalKnowledgeBaseFiles > 0">
      <div class="section-header">
        <h3>Knowledge Base</h3>
        <p class="section-subtitle">Files and documents in your knowledge base</p>
      </div>
      <div class="knowledge-stats">
        <div class="stat-item">
          <div class="stat-icon">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path>
              <polyline points="13 2 13 9 20 9"></polyline>
            </svg>
          </div>
          <div class="stat-content">
            <div class="stat-value">{{ analytics.totalKnowledgeBaseFiles | number }}</div>
            <div class="stat-label">Knowledge Base Files</div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
